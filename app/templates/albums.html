{% extends "base.html" %}
{% block title %}Coleção · retrofagia{% endblock %}
{% block content %}
<section class="grid">
  <div class="column main-feed">
    <article class="card">
      <h1>Sua coleção</h1>
      <form method="post" class="form inline-form" enctype="multipart/form-data">
        <label>Título
          <input type="text" name="title" placeholder="Nome do álbum" required />
        </label>
        <label>Artista
          <input type="text" name="artist" placeholder="Artista ou banda" required />
        </label>
        <label>Capa
          <input type="file" name="cover" accept="image/png,image/jpeg,image/jpg,image/gif,image/webp" />
          <span class="input-hint muted">Opcional · PNG, JPG, GIF ou WEBP até 4MB.</span>
        </label>
        <button type="submit">Adicionar</button>
      </form>
    </article>

    <article class="card album-search-card">
      <h2>Buscar álbuns já cadastrados</h2>
      <p class="muted">Evite duplicar: digite título ou artista e adicione direto da comunidade.</p>
      <div class="album-search">
        <label>Busca rápida
          <input
            type="text"
            placeholder="Ex.: Loveless, Radiohead, etc."
            data-album-search-input
            autocomplete="off"
          />
        </label>
      </div>
      <div class="album-search-results" data-album-search-results>
        <p class="muted">Sem resultados ainda. Comece digitando acima.</p>
      </div>
    </article>

    <div class="album-grid">
      {% for album in albums %}
      <article class="card album-card">
        <a class="album-link" href="{{ url_for('main.album_detail', album_id=album.id) }}">
          {% if album.cover_url %}
          <img src="{{ album.cover_url | image_url }}" alt="Capa de {{ album.title }}" />
          {% else %}
          <div class="album-cover-placeholder">{{ album.title[0]|upper }}</div>
          {% endif %}
        </a>
        <div class="album-meta">
          <a href="{{ url_for('main.album_detail', album_id=album.id) }}">
            <h2>{{ album.title }}</h2>
          </a>
          <p class="muted">{{ album.artist }}</p>
        </div>
        <form method="post" action="{{ url_for('main.delete_album', album_id=album.id) }}">
          <button type="submit" class="ghost">Remover</button>
        </form>
      </article>
      {% else %}
      <article class="card empty">
        <p>Sem álbuns cadastrados. Use o formulário acima para começar.</p>
      </article>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}
