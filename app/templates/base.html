<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}retrofagia{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <script src="{{ url_for('static', filename='app.js') }}" defer></script>
  </head>
  <body
    {% if page_class %}class="{{ page_class }}"{% endif %}
    {% if current_user.is_authenticated %}
    data-authenticated="true"
    data-user-id="{{ current_user.id }}"
    {% else %}
    data-authenticated="false"
    {% endif %}
  >
    <header class="topbar">
      <div class="brand-row">
        <a class="brand" href="{{ url_for('main.index') }}" aria-label="Ir para a página inicial">retrofagia</a>
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('main.search') }}" class="search-button" aria-label="Buscar">
          <svg viewBox="0 0 24 24">
            <path d="M11 4a7 7 0 1 1 0 14 7 7 0 0 1 0-14zm8.5 15.5L16 16" fill="none"/>
          </svg>
        </a>
        {% endif %}
      </div>
      {% if current_user.is_authenticated %}
      <a class="logout-button" href="{{ url_for('auth.logout') }}" aria-label="Sair">
        <svg viewBox="0 0 24 24">
          <path d="M10 5h-5v14h5M14 16l4-4-4-4M18 12H9" fill="none"/>
        </svg>
      </a>
      {% endif %}
    </header>

    <main class="content">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <div class="flash-container">
        {% for category, message in messages %}
        <div class="flash {{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
      {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </main>
    {% if current_user.is_authenticated %}
    <nav class="bottom-nav" aria-label="Navegação inferior">
      <a href="{{ url_for('main.feed') }}" class="bottom-nav-item">
        <span class="sr-only">Feed</span>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M4 10.5 12 4l8 6.5V20a1 1 0 0 1-1 1h-4.5v-6h-5v6H5a1 1 0 0 1-1-1z" fill="none"/>
        </svg>
      </a>
      <a href="{{ url_for('main.albums') }}" class="bottom-nav-item">
        <span class="sr-only">Coleção</span>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="12" cy="12" r="7" fill="none" stroke="currentColor"/>
          <circle cx="12" cy="12" r="2.5" fill="currentColor" stroke="none"/>
        </svg>
      </a>
      <a href="{{ url_for('main.chat') }}" class="bottom-nav-item">
        <span class="sr-only">Chats</span>
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M4 5h16v10H8l-4 4z" fill="none"/>
        </svg>
        <span class="notification-badge" data-notification="message" aria-hidden="true"></span>
      </a>
      <a href="{{ url_for('main.my_profile') }}" class="bottom-nav-item avatar">
        <span class="sr-only">Perfil</span>
        {% if current_user.avatar_url %}
        <img src="{{ current_user.avatar_url | image_url }}" alt="" aria-hidden="true"/>
        {% else %}
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="12" cy="8" r="3.5" fill="none"/>
          <path d="M5 19c1.5-4 5.5-4 7-4s5.5 0 7 4" fill="none"/>
        </svg>
        {% endif %}
      </a>
    </nav>
    {% endif %}
  </body>
</html>
